import{f as q}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{T as A,a as B}from"./chunk-MSDRGCRR-Wo7ejLev.js";import{u as K}from"./chunk-W7625H47-BR4t6Gd7.js";import{a1 as O,ad as I,a3 as Q,R as V,aS as $,j as t,b,a8 as G,a9 as U,r as f,eK as Z,eN as J,t as y,B as P,k as W}from"./index-BxRPZUbt.js";import{u as X,D as Y}from"./chunk-OYHBAUAW-Bh910uOp.js";import"./lodash-Wa3tNvWF.js";import{u as ee}from"./chunk-C76H5USB-C4KynttQ.js";import"./chunk-FZFMTVUS-B6epN2ER.js";import"./chunk-BNLHRJ2A-Cy9oezEa.js";import"./chunk-KHOKHZC6-BT2W526V.js";import{K as te}from"./chunk-6HTZNHPT-Bt4ap2B-.js";import{R as n,u as oe}from"./chunk-6DAFMWMA-CLcEtfHI.js";import{C as j}from"./checkbox-CGs03nqI.js";import{c as _}from"./index-BpYtoVSX.js";import"./chunk-P3UUX2T6-BqASRlOM.js";import"./chunk-YEDAFXMB-Q_4fYbM3.js";import"./chunk-AOFGTNG6-D4HQXs0t.js";import"./chunk-WX2SMNCD-CYNKb9PK.js";import"./plus-mini-CSilrpvR.js";import"./command-bar-Bfh-9oY8.js";import"./index-B2CyCadw.js";import"./chunk-IVEEMMLZ-CPRLM5_J.js";import"./format-CSM4n_jz.js";import"./date-picker-BUKrjaEd.js";import"./clsx-B-dksMZM.js";import"./popover-DP_copnG.js";import"./x-mark-mini-CdT8Gfml.js";import"./triangle-left-mini-BVg8f3e8.js";import"./prompt-Ad_DCR5S.js";var se=_(),re=()=>{const{t:o}=b();return f.useMemo(()=>[se.accessor("id",{header:()=>t.jsx(A,{text:"Provider"}),cell:({getValue:e})=>t.jsx(B,{text:q(e())})})],[o])},ae=({prefix:o,pageSize:e=20})=>{const s=ee(["offset","q","stock_location_id"],o),{offset:l,q:c,stock_location_id:m}=s;return{searchParams:{limit:e,offset:l?Number(l):0,stock_location_id:m,q:c},raw:s}},ie=O({fulfillment_providers:I(Q()).optional()}),d=50,le=({location:o})=>{var v,x;const{t:e}=b(),{handleSuccess:s}=oe(),l=G({defaultValues:{fulfillment_providers:((v=o.fulfillment_providers)==null?void 0:v.map(r=>r.id))??[]},resolver:U(ie)}),{setValue:c}=l,m=((x=o.fulfillment_providers)==null?void 0:x.reduce((r,a)=>(r[a.id]=!0,r),{}))??{},[u,k]=f.useState(m),C=r=>{const a=typeof r=="function"?r(u):r;c("fulfillment_providers",Object.keys(a),{shouldDirty:!0,shouldTouch:!0}),k(a)},{searchParams:F,raw:w}=ae({pageSize:d}),{fulfillment_providers:T,count:p,isLoading:R,isError:E,error:D}=Z({...F,is_enabled:!0},{placeholderData:W}),L=K(),h=ce(),{table:z}=X({data:T??[],columns:h,count:p,enablePagination:!0,enableRowSelection:!0,rowSelection:{state:u,updater:C},getRowId:r=>r.id,pageSize:d}),{mutateAsync:H,isPending:M}=J(o.id),N=l.handleSubmit(async r=>{var S;const a=(S=o.fulfillment_providers)==null?void 0:S.map(i=>i.id),g=r.fulfillment_providers??[];await H({add:g.filter(i=>!(a!=null&&a.includes(i))),remove:a==null?void 0:a.filter(i=>!g.includes(i))},{onSuccess:({stock_location:i})=>{y.success(e("stockLocations.fulfillmentProviders.successToast")),s(`/settings/locations/${i.id}`)},onError:i=>{y.error(i.message)}})});if(E)throw D;return t.jsx(n.Form,{form:l,children:t.jsxs(te,{onSubmit:N,className:"flex size-full flex-col",children:[t.jsx(n.Header,{}),t.jsx(n.Body,{className:"flex flex-1 flex-col overflow-auto",children:t.jsx(Y,{table:z,columns:h,pageSize:d,isLoading:R,count:p,filters:L,search:"autofocus",pagination:!0,orderBy:[{key:"id",label:e("fields.id")}],queryObject:w,layout:"fill"})}),t.jsx(n.Footer,{children:t.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[t.jsx(n.Close,{asChild:!0,children:t.jsx(P,{size:"small",variant:"secondary",type:"button",children:e("actions.cancel")})}),t.jsx(P,{size:"small",isLoading:M,type:"submit",children:e("actions.save")})]})})]})})},ne=_(),ce=()=>{const o=re();return f.useMemo(()=>[ne.display({id:"select",header:({table:e})=>t.jsx(j,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:s=>e.toggleAllPageRowsSelected(!!s)}),cell:({row:e})=>t.jsx(j,{checked:e.getIsSelected(),onCheckedChange:s=>e.toggleSelected(!!s),onClick:s=>{s.stopPropagation()}})}),...o],[o])},Ae=()=>{const{location_id:o}=V(),{stock_location:e,isPending:s,isError:l,error:c}=$(o,{fields:"id,*fulfillment_providers"}),m=!s&&!!e;if(l)throw c;return t.jsx(n,{children:m&&t.jsx(le,{location:e})})};export{Ae as Component};
